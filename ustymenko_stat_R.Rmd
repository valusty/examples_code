---
title: "Cтатистика"
author: "Валерія Устименко"
output: 
  md_document:
    toc: TRUE
---

# Завдання 1

```{r}
library(readxl)
L1 <- read_excel("D:/work_biph/phd/study/stat/stat1_L1/L1.xlsx", 
    col_types = c("text", "text", "numeric", 
        "numeric", "numeric", "text", "numeric", 
        "numeric"))
View(L1)
```

Спочатку було трошки змінено таблицю: спрощено назви в першому рядку та додано стовпчик, що вказував на групу, до якої належали пацієнти.

Враховуючи, що у нас в стовпчику "GENDER" присутні текстові дані, даний стовпчик було переведено в фактор з використанням функції:

```{r}
L1$GENDER <- as.factor(L1$GENDER)
```

Далі з наявного масиву даних ми обирали необхідні нам спостереження, що належать до однієї експериментальної групи наступним чином:

```{r}
control <- L1[which(L1$G=='control'),]
park <- L1[which(L1$G=='park'),]
hunt <- L1[which(L1$G=='hunt'),]
als <- L1[which(L1$G=='als'),]
```

Надалі з використанням стандартних функцій базового пакету R було визначено:

-   Для показників з кількісними даними ("AGE", "HEIGHT", "WEIGHT") мінімальні значення (Min.); значення, що припадає на 1-й квартиль (1st Qu.); медіана (Median); середнє арифметичне (Mean); значення, що припадає на 3-й квартиль (3rd Qu.); максимальне значення (Max.); кількість значень, що були упущені при проведенні дослідження (NA\`s);

-   Для фактору "GENDER": кількість значень, що характеризують стать ("f", "m").\

Стовпчики "SPEED" та "SEVERITY" не бралися до уваги. Дані показники було визначено наступним чином:

```{r}
summary(control)
```

```{r}
summary(park)
```

```{r}
summary(hunt)
```

```{r}
summary(als)
```

Паралельно було додано бібліотеку pastecs з використанням функції:

```{r}
library(pastecs)
```

```{r}
stat.desc(control)
```

```{r}
stat.desc(park)
```

```{r}
stat.desc(hunt)
```

```{r}
stat.desc(als)
```

## Отримані результати

-   Контрольна група складається з 16 пацієнтів. Вік в контрольній групі від 20 до 74 років, при цьому середній вік пацієнтів 39 років а медіанний вік становить 35 років. Зріст варіюється від 1.67 до 1.94 метра, і середнє значення становить 1.83 ± 0.08 метра, медіанний зріст становить 1.83 метра; стандартна похибка для даного показника становить 0.02, коефіцієнт варіації -- 0.04. Вага пацієнтів розподілена в діапазоні від 50 до 95 кілограмів, і середнє значення складає 66.81 ± 11.08 кілограма, медіана -- 65.00 кг; стандартна похибка становить 2.80 , коефіцієнт варіації 0.17. У групі переважають жінки (14 осіб) порівняно з чоловіками (2 особи).

-   Друга група, пацієнтів хворих на хворобу Паркінсона, складається з 15 пацієнтів. Вік в даній групі від 44 до 80 років, при цьому середній вік пацієнтів 67 років, медіанний вік становить 68 років. Зріст варіюється від 1.67 до 2.13 метра, середній зріст становить 1.87 ± 0.15 метра, тоді як медіанний зріст становить 1.92 метра; стандатна похибка для даного показника становить 0.04, коефіцієнт варіації -- 0.08. Вага пацієнтів розподілена в діапазоні від 43 до 100 кілограмів, в середньому 75.06 ± 16.90 кілограма, медіана -- 77.00 кг; стандартна похибка становить 4.36, коефіцієнт варіації 0.26. У групі переважають чоловіки (10 осіб) порівняно з жінками (5 осіб).

-   Третя група складається з 20 пацієнтів хворих на хворобу Гантінгтона. Середній вік в даній групі становить 47 років, при тому що вік в даній групі має діапазон від 29 до 71 років, медіанний вік становить 44.5 років. Зріст варіюється від 1.57 до 2.00 метра, і середнє значення становить 1.83 ± 0.11 метра, медіанний зріст становить 1.82 метра; стандартна похибка для даного показника становить 0.02, коефіцієнт варіації -- 0.06. Вага пацієнтів варіює від 45 до 102 кілограмів, і середнє значення складає 72.05 ± 17.04 кілограма, медіанна вага складає 73.50 кг; стандартна похибка становить 3.81, коефіцієнт варіації 0.24. У групі переважають жінки (14 осіб) порівняно з чоловіками (6 особи).

-   Група хворих на бічний аміотрофічний склероз складалась з 3 пацієнтів, в якій кількісно переважали чоловіки (10 осіб) над жінками (3 особи). Пацієнти мали вік від 36 до 70 років, середній вік пацієнтів становив 56 років, медіанний -- 62. Зріст пацієнтів був в проміжку від 1.57 до 1.88 метра, середнє значення складає 1.74 ± 0.10 метра, медіана -- 1.75 метра; стандартна похибка становила 0.03, коефіцієнт варіації -- 0.05. Вага була невідома для одного пацієнта, але грунтуючись на даних, відомих для інших 12 пацієнтів можна сказати, що їх вага варіює в діапазоні між 40.82 та 117.50 кг, середня вага становить 77.12 ± 21.14 кг, медіанна -- 78.02 кг; стандартна похибка становить 6.11, коефіцієнт варіації -- 0.27.\

# Завдання 2

Для початку було імпортовано таблицю, що містить наступні зміни: спрощені назви в першому рядку; доданий стовпчик, в якому вказана група до якого належить пацієнт; змінений тип даних на "numeric"в стовпчиках, які цього потребують ("AGE", "HEIGHT", "WEIGHT", "SPEED" та "SEVERITY").

Загалом, в таблиці представлені дані 64 осіб, що поділено на 4 групи: контрольна ("control"), хворі на хворобу Паркінсона ("park"), хворобу Гантінгтона ("hunt") та бічний аміотрофічний склероз (БАС, "als"). Під час імпорту даних було виявлено, що в стовпчику "WEIGHT" випадає одне значення для пацієнта з БАС, тоді як в "SPEED" є три значення, що випадають в групах хворих на хвороби Гантінгтона (для 1-го пацієнта) та БАС (для 2-х пацієнтів).

## Контроль

Далі аналізували дані по групам. Спочатку було розділено наявний датасет на 4 піддатасети. Дані групи "control" від інших груп було відокремлено наступним чином:

```{r}
control <- L1[which(L1$G=='control'),]
```

До групи "control" входять 16 осіб. В межах даної групи в стовпчиках "HEIGHT", "WEIGHT" "SPEED" всі необхідні дані присутні.

Було створено гістограми з використанням функції hist():

```{r}
hist(control$SPEED)
```

Візуально аналізуючи утворені гістограми можна стверджувати, що для даних в групі "control", показника "SPEED" характерний нормальний розподіл даних.

```{r}
hist(control$HEIGHT)
```

Візуально аналізуючи утворені гістограми можна стверджувати, що для даних в групі "control", показника "HEIGHT" нормальний розподіл даних відсутній.

```{r}
hist(control$WEIGHT)
```

Візуально аналізуючи утворені гістограми можна стверджувати, що для даних в групі "control", показника "WEIGHT" нормальний розподіл даних відсутній.

Далі були створені графіки з використанням функції qqPlot() з пакету "car" для порівняння емпіричного та нормального розподілів:

```{r}
library(car)
qqPlot(control$SPEED)
```

Аналізуючи Q-Q plot, побудований на основі даних, що знаходяться в стовпчику "SPEED", можна припустити, що твердження, побудоване на основі гістограми розподілу даних, побудованого в попередньому кроці, щодо того що дані розподіляються нормально, все ж таки може бути дійсним.

```{r}
qqPlot(control$HEIGHT)
```

Аналізуючи Q-Q plot, побудований на основі даних, що знаходяться в стовпчику "HEIGHT", можна припустити, що твердження, побудоване на основі гістограми розподілу даних, побудованого в попередньому кроці, щодо того що дані розподіляються нормально, все ж таки може бути хибним.

```{r}
qqPlot(control$WEIGHT)
```

Аналізуючи Q-Q plot, побудований на основі даних, що знаходяться в стовпчику "WEIGHT", можна припустити, що твердження, побудоване на основі гістограми розподілу даних, побудованого в попередньому кроці, щодо того що дані розподіляються нормально, як і в попередньому випадку, може бути хибним.

Проте дані твердження потребують подальшої перевірки, з використанням критерію Шапіро-Вілка:

```{r}
shapiro.test(control$SPEED)
```

У результаті тесту Шапіро-Вілка було виявлено, що для даних в колонці "SPEED" критерій W = 0,875, p = 0,033. Якщо для того, щоб прийняти нульову гіпотезу про те, що у нас присутній нормальний розподіл даних за рівня значущості p ≥ 0,05, то можемо стверджувати, що в колонці "SPEED", попри всі припущення створені на основі побудованих гістограми та Q-Q графіку, нормальний розподіл даних відсутній.

```{r}
shapiro.test(control$HEIGHT)
```

У результаті тесту Шапіро-Вілка було виявлено, що для даних в колонці "HEIGHT" критерій W = 0,953, p = 0,555. Якщо для того, щоб прийняти нульову гіпотезу про те, що у нас присутній нормальний розподіл даних за рівня значущості p ≥ 0,05, то можемо стверджувати, що в колонці "HEIGHT" присутній нормальний розподіл даних.

```{r}
shapiro.test(control$WEIGHT)
```

У результаті тесту Шапіро-Вілка було виявлено, що для даних в колонці "WEIGHT" критерій W = 0,931, p = 0,258. Якщо для того, щоб прийняти нульову гіпотезу про те, що у нас присутній нормальний розподіл даних за рівня значущості p ≥ 0,05, то можемо стверджувати, що в колонці "WEIGHT" присутній нормальний розподіл даних.

## Хвороба Паркінсона

Далі було проаналізовано результати тесту ходи та ступінь розвитку захворювання для пацієнтів, що мають хворобу Паркінсона. Дані групи "park" від інших груп було відокремлено наступним чином:

```{r}
park <- L1[which(L1$G=='park'),]
```

В групу "park" входить 15 осіб, хворих на хворобу Паркінсона. Жодне з значень в стовпчиках, що необхідні для подальшого аналізу, не було випущено.

Для початку з використанням функції hist() були створені гістограми для значень в колонках "SPEED" та отримано наступні графіки:

```{r}
hist(park$SPEED)
```

```{r}
hist(park$HEIGHT)
```

Спираючись на візуальну оцінку, здається, що в колонці "HEIGHT" дані нормально не розподілені.

```{r}
hist(park$WEIGHT)
```

Спираючись на візуальну оцінку, здається, що в колонці "WEIGHT" дані нормально не розподілені.

Далі були створені з використанням функції qqPlot() наступні графіки:

```{r}
qqPlot(park$SPEED)
```

Графіки, що були утворені в результаті використання вищезгаданої функції, викликали сумніви, щодо коректності попереднього припущення. Таким чином, на основі Q-Q plot можна допустити, що дані розподілені нормально.

```{r}
qqPlot(park$HEIGHT)
```

Графіки, що були утворені в результаті використання вищезгаданої функції, викликали сумніви, щодо коректності попереднього припущення. Таким чином, на основі Q-Q plot можна допустити, що дані розподілені нормально.

```{r}
qqPlot(park$WEIGHT)
```

Графіки, що були утворені в результаті використання вищезгаданої функції, викликали сумніви, щодо коректності попереднього припущення. Таким чином, на основі Q-Q plot можна допустити, що дані розподілені нормально.

Для того, щоб впевнитися, який же розподіл даних, що нас цікавлять в групі "park" та чи приймаємо ми нульову теорію, що полягає в тому, що наші дані розподілені нормально, було проведено тест Шапіро-Вілка:

```{r}
shapiro.test(park$SPEED)
```

Відповідно до результатів тесту, критерій, обрахований на основі даних в колонці "SPEED" становить W = 0,933, p = 0,310. Враховуючи, що р ≥ 0,05, то можна стверджувати, що для значень "SPEED" групи "park" притаманний нормальний розподіл даних.

```{r}
shapiro.test(park$HEIGHT)
```

Відповідно до результатів тесту, критерій, обрахований на основі даних в колонці "HEIGHT" становить W = 0,918, p = 0,180. Враховуючи, що р ≥ 0,05, то можна стверджувати, що для значень "HEIGHT" групи "park" притаманний нормальний розподіл даних.

```{r}
shapiro.test(park$WEIGHT)
```

Відповідно до результатів тесту, критерій, обрахований на основі даних в колонці "WEIGHT" становить W = 0,955, p = 0,608. Враховуючи, що р ≥ 0,05, то можна стверджувати, що для значень "WEIGHT" групи "park" притаманний нормальний розподіл даних.

## Хвороба Гантінгтона

Далі було проаналізовано результати тесту ходи та ступінь розвитку захворювання для пацієнтів, що мають хворобу Гантінгтона. Дані групи "hunt" від інших груп було відокремлено наступним чином:

```{r}
hunt <- L1[which(L1$G=='hunt'),]
```

В групу "hunt" входить 20 осіб, хворих на хворобу Гантінгтона. Було виявлено, що одне зі значень в колонці "SPEED" було випущено.

Було створено гістограми з використанням функції hist():

```{r}
hist(hunt$SPEED)
```

Спираючись на візуальну оцінку, здається, що в колонці "SPEED" дані нормально розподілені.

```{r}
hist(hunt$HEIGHT)
```

Спираючись на візуальну оцінку, здається, що в колонці "HEIGHT" дані нормально не розподілені.

```{r}
hist(hunt$WEIGHT)
```

Спираючись на візуальну оцінку, здається, що в колонці "WEIGHT" дані нормально розподілені.

Далі були створені з використанням функції qqPlot() наступні графіки:

```{r}
qqPlot(hunt$SPEED)
```

Створений графік підтверджує попереднє припущення про те, що в стовпчику "SPEED" присутній нормальний розподіл даних.

```{r}
qqPlot(hunt$HEIGHT)
```

Створений графік не підтверджує попереднє припущення про те, що в стовпчику "HEIGHT" не присутній нормальний розподіл даних.

```{r}
qqPlot(hunt$WEIGHT)
```

Створений графік підтверджує попереднє припущення про те, що в стовпчику "WEIGHT" присутній нормальний розподіл даних.

Але всяке припущення має пройти певну перевірку для того щоб стати ствердженням, тому використовуємо тест Шапіро-Вілка, на основі якого ми або приймемо, або відкинемо нульову гіпотезу щодо нормальності розподілу даних:

```{r}
shapiro.test(hunt$SPEED)
```

У результаті тесту на нормальність Шапіро-Вілка, було виявлено, що для стовпчика "SPEED" W = 0,944, р = 0,311. Враховуючи, що представлені дані вважаються нормальними за рівня значущості 0,311, що є більшим за 0,05, в даному випадку ми приймаємо нульову гіпотезу.

```{r}
shapiro.test(hunt$HEIGHT)
```

У результаті тесту на нормальність Шапіро-Вілка, було виявлено, що для стовпчика "HEIGHT" W = 0,957, р = 0,486. Враховуючи, що представлені дані вважаються нормальними за рівня значущості 0,486, що є більшим за 0,05, в даному випадку ми приймаємо нульову гіпотезу.

```{r}
shapiro.test(hunt$WEIGHT)
```

У результаті тесту на нормальність Шапіро-Вілка, було виявлено, що для стовпчика "WEIGHT" W = 0,957, р = 0,488. Враховуючи, що представлені дані вважаються нормальними за рівня значущості 0,488, що є більшим за 0,05, в даному випадку ми приймаємо нульову гіпотезу.

## БАС

І наостанок було проаналізовано результати тесту ходи та ступінь розвитку захворювання для пацієнтів, що мають БАС. Дані групи "als" від інших груп було відокремлено наступним чином:

```{r}
als <- L1[which(L1$G=='als'),]
```

В групу "als" входить 13 осіб, хворих на БАС. Було виявлено, що два значення в колонці "SPEED" було випущено, а в колонці "WEIGHT" - одне.

Для початку з використанням функції hist() були створені гістограми для значень в колонках "SPEED" та отримано наступні графіки:

```{r}
hist(als$SPEED)
```

Візуально аналізуючи утворені гістограми можна стверджувати, що для даних в групі "als" для показника "SPEED" нормальний розподіл даних відсутній.

```{r}
hist(als$HEIGHT)
```

Візуально аналізуючи утворені гістограми можна стверджувати, що для даних в групі "als" для показника "HEIGHT" нормальний розподіл даних відсутній.

```{r}
hist(als$WEIGHT)
```

Візуально аналізуючи утворені гістограми можна стверджувати, що для даних в групі "als" для показника "WEIGHT" нормальний розподіл даних присутній.

Далі були створені графіки з використанням функції qqPlot() з пакету "car" для порівняння емпіричного та нормального розподілів:

```{r}
qqPlot(als$SPEED)
```

Аналізуючи Q-Q plot, побудований на основі даних, що знаходяться в стовпчику "SPEED", можна припустити, що твердження, побудоване на основі гістограми розподілу даних, побудованого в попередньому кроці, щодо того що дані не розподіляються нормально, все ж таки може бути дійсним.

```{r}
qqPlot(als$HEIGHT)
```

Аналізуючи Q-Q plot, побудований на основі даних, що знаходяться в стовпчику "HEIGHT", можна припустити, що твердження, побудоване на основі гістограми розподілу даних, побудованого в попередньому кроці, щодо того що дані не розподіляються нормально, все ж таки може бути хибним.

```{r}
qqPlot(als$WEIGHT)
```

Аналізуючи Q-Q plot, побудований на основі даних, що знаходяться в стовпчику "WEIGHT", можна припустити, що твердження, побудоване на основі гістограми розподілу даних, побудованого в попередньому кроці, щодо того що дані розподіляються нормально, все ж таки може бути вірним. Проте дані твердження потребують подальшої перевірки з використанням критерію Шапіро-Вілка:

```{r}
shapiro.test(als$SPEED)
```

У результаті проведення тесту Шапіро-Вілка було виявлено, що для стовпчика "SPEED" W = 0,837, р = 0,029. Враховуючи, що ми приймаємо нульову гіпотезу щодо нормальності розподілу даних за p ≥ 0,05, можна стверджувати, що в даних нормальний розподіл відсутній.

```{r}
shapiro.test(als$HEIGHT)
```

У результаті проведення тесту Шапіро-Вілка було виявлено, що для стовпчика "HEIGHT" W = 0,923, р = 0,282. Враховуючи, що ми приймаємо нульову гіпотезу щодо нормальності розподілу даних за p ≥ 0,05, можна стверджувати, що в даних нормальний розподіл присутній.

```{r}
shapiro.test(als$WEIGHT)
```

У результаті проведення тесту Шапіро-Вілка було виявлено, що для стовпчика "WEIGHT" W = 0,964, р = 0,840. Враховуючи, що ми приймаємо нульову гіпотезу щодо нормальності розподілу даних за p ≥ 0,05, можна стверджувати, що в даних нормальний розподіл присутній.\

## Отримані результати

### Контроль

-   Аналізуючи гістограми, було виявлено, що для даних у групі "control" показник "SPEED" проявляє нормальний розподіл. Аналізуючи Q-Q графік для "SPEED", було припущено, що дані можуть мати нормальний розподіл.

-   Результати тесту Шапіро-Вілка підтверджують альтернативну гіпотезу для "SPEED": критерій W дорівнює 0,875, p = 0,033, що вказує на відхилення від нормального розподілу, оскільки p \< 0,05.

-   Аналізуючи гістограму для даних у групі "control" показника "HEIGHT", було припущено, що вона не вказує на наявність нормального розподілу даних. При огляді Q-Q графіку, побудованого на основі значень у стовпчику "HEIGHT", було припущено, що твердження про відсутність нормального розподілу, зроблене на підставі гістограми, може бути невірним.

-   Результати тесту Шапіро-Вілка показали, що для даних у стовпчику "HEIGHT" критерій W = 0,953, p = 0,555. При врахуванні рівня значущості p ≥ 0,05, було виявлено, що у стовпчику "HEIGHT" спостерігається нормальний розподіл даних.

-   Дивлячись на гістограму для даних у групі "контроль" показника "WEIGHT", було припущено, що вона не вказує на наявність нормального розподілу даних. При аналізі Q-Q графіку, побудованого на основі значень у стовпчику "WEIGHT", так само, як і в попередньому випадку, було припущено, що твердження про нормальний розподіл, зроблене на підставі гістограми, може бути хибним.

-   Результати тесту Шапіро-Вілка показали, що для даних у стовпчику "WEIGHT" критерій W = 0,931, p = 0,258. З урахуванням рівня значущості p ≥ 0,05, було виявлено, що у стовпчику "WEIGHT" спостерігається нормальний розподіл даних.

### Хвороба Паркінсона

-   Базуючись на візуальній оцінці гістограм, виникло враження, що дані в колонці "SPEED" не мають нормального розподілу. Графіки, сформовані за допомогою функції qqPlot(), викликали сумніви щодо вірності початкового припущення. Таким чином, було зроблено нове припущення, що дані розподілені нормально.

-   Згідно з результатами тесту, критерій Шапіро-Вілка розрахований для "SPEED", становить W = 0,933, p = 0,310. Оскільки p ≥ 0,05, можна стверджувати, що у значень показника "SPEED" у групі "park" наявний нормальний розподіл даних.

-   Спираючись на візуальну оцінку гістограми, було припущено, що в колонці "HEIGHT" дані нормально не розподілені. В результаті аналізу Q-Q графіка було припущено, що дані можуть мати нормальний розподіл.

-   Результати тесту Шапіро-Вілка для колонки "HEIGHT" показали, що критерій W = 0,918, p = 0,180. З урахуванням рівня значущості p ≥ 0,05, було прийдено до висновку, що для значень "HEIGHT" у групі "park" спостерігається нормальний розподіл.

-   Оцінюючи візуально гістограми було припущено, що в колонці "WEIGHT" ймовірно відсутній нормальний розподіл даних. На противагу, аналіз Q-Q графіка було припущено, що дані можуть мати нормальний розподіл.

-   Результати тесту Шапіро-Вілка для колонки "WEIGHT" показали, що критерій W = 0,955, p = 0,608. З урахуванням рівня значущості p ≥ 0,05, можна зробити висновок, що для значень "WEIGHT" у групі "park" спостерігається нормальний розподіл.

### Хвороба Гантінгтона

-   Після візуальної оцінки гістограм виникло припущення, що дані у колонці "SPEED" мають нормальний розподіл. Створені Q-Q графіки підтвердили припущення щодо наявності нормального розподілу даних у "SPEED".

-   Результати тесту на нормальність Шапіро-Вілка для "SPEED" показали, що W = 0,944, p = 0,311. Оскільки значення p ≥ 0,311 перевищує рівень значущості 0,05, у цьому випадку ми приймаємо нульову гіпотезу про нормальний розподіл даних.

-   Оцінюючи візуально гістограми було припущено, що в колонці "HEIGHT" дані можливо не мають нормального розподілу. Q-Q графік, створений на основі даних, не підтвердив попереднє припущення про відсутність нормального розподілу у стовпчику "HEIGHT".

-   У результаті тесту на нормальність Шапіро-Вілка, було виявлено, що для стовпчика "HEIGHT" W = 0,957, р = 0,486. Враховуючи, що представлені дані вважаються нормальними за рівня значущості 0,486, що є більшим за 0,05, в даному випадку ми приймаємо нульову гіпотезу.

-   Глядаючи на візуальні дані, було припущено, що в колонці "WEIGHT" дані ймовірно мають нормальний розподіл. Q-Q графік підтверджує наявність нормального розподілу у стовпчику "WEIGHT".

-   Результати тесту на нормальність Шапіро-Вілка для стовпчика "WEIGHT" показали, що W = 0,957, p = 0,488. З урахуванням того, що значення p = 0,488, що перевищує рівень значущості 0,05, було прийнято нульову гіпотезу про наявність нормального розподілу даних.

### БАС

-   Аналізуючи гістограми, було припущено, що для числових даних у групі "als", як для "SPEED" нормальний розподіл відсутній. При аналізі Q-Q plot, побудованого на основі "SPEED", можна припустити, що ствердження, зроблене на підставі гістограми розподілу даних у попередньому етапі, що дані не розподіляються нормально, може бути вірним.

-   У результаті тесту Шапіро-Вілка для "SPEED" було виявлено, що W = 0,837, p = 0,029. Враховуючи, що ми приймаємо нульову гіпотезу про нормальність розподілу даних за умови p ≥ 0,05, можна стверджувати, що для показника "SPEED" в групі "als" нормальний розподіл відсутній.

-   Візуальний аналіз утворених гістограм можна стверджувати, що для даних в групі "als" для показника "HEIGHT" нормальний розподіл даних відсутній. Аналізуючи Q-Q plot, побудований на основі даних, що знаходяться в стовпчику "HEIGHT" було припущено, що для даних все ж таки притаманний нормальний розподіл.

-   У результаті проведення тесту Шапіро-Вілка було виявлено, що для стовпчика "HEIGHT" W = 0,923, р = 0,282. З урахуванням того, що ми приймаємо нульову гіпотезу про нормальність розподілу даних за умови p ≥ 0,05, можна заключити, що у даних присутній нормальний розподіл.

-   При візуальному аналізі гістограм для даних у групі "als" за показником "WEIGHT" було припущено, що вони мають нормальний розподіл. Аналіз Q-Q графіку, побудованого на основі даних у стовпчику "WEIGHT", підтвердило дане припущення.

-   Результати тесту Шапіро-Вілка для стовпчика "WEIGHT" показали, що W = 0,964, p = 0,840. З урахуванням того, що ми приймаємо нульову гіпотезу про нормальність розподілу даних за умови p ≥ 0,05, прийшли до висновку, що у даних присутній нормальний розподіл.

# Завдання 3

Для початку було імпортовано таблицю, що містить спрощені назви в першому рядку та змінений тип даних на "numeric" в стовпчиках, які цього потребують. Загалом представлено дані 166 осіб, що поділено на 2 групи: контрольна (СО, 93 особи) та хворі на хворобу Паркінсона (PD, 73 особи). 

```{r}
library(readxl)
L3 <- read_excel("D:/work_biph/phd/study/stat/stat3_L3/L3.xlsx", 
    col_types = c("text", "text", "numeric", 
        "text", "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric"))
View(L3)
```

Далі було додано необхідні для подальшої роботи пакети:

```{r}
library(dplyr)
```

```{r}
library(ggplot2)
```

Надалі порівнювали зріcт ("Height"), параметри тесту ТUAG ("TUAG") та швидкість ходи ("Speed01") між здоровими людьми та пацієнтами.

## Зріст

Для початку було змінено дані в колонці через те, що частина даних представлені не в метрах, як зазначено в назві колонки, а в сантиметрах. Оскільки нам всюди потрібно щоб дані були в одному форматі та одній розмірності, то дані було безпосередньо в початковому датасеті. Для цього всі значення, більші за 3 (на випадок, якщо є хтось вище за 2 м) були поділені на 100 наступним чином:

```{r}
L3$Height<- ifelse(L3$Height > 3 & !is.na(L3$Height),
                   L3$Height / 100, L3$Height)
```

Далі було описано дані для кожної з груп:

```{r}
summary (L3$Height[L3$Group == 'CO'])
```

```{r}
summary (L3$Height[L3$Group == 'CO'])
```

Також обрахували стандартне відхилення:

```{r}
sd(L3$Height[L3$Group == 'CO'], na.rm = TRUE)
```

```{r}
sd(L3$Height[L3$Group == 'PD'], na.rm = TRUE)
```

Потім дані було представлено графічно з використанням density plot а також "ящика з вусиками".

```{r}
ggplot(L3, aes(x = Group, y = Height)) +
    geom_boxplot() +
    labs(title = "Distribution of Height in PD and CO",
            x = "Group",
            y = "Height, m")
```

```{r}
ggplot(L3, aes(x = Height, fill = Group)) +
    geom_density(alpha = 0.7) +
    labs(title = "Density Plot of Height in CO and PD",
         x = "Height, m",
         y = "Density")
```

Далі, для того, щоб дізнатися чи наші дані розподілені нормально, було проведено тест Шапіро-Вілка:

```{r}
shapiro.test (L3$Height[L3$Group == 'CO'])
```

```{r}
shapiro.test (L3$Height[L3$Group == 'PD'])
```

Відповідно до результатів тесту, критерій, обрахований на основі даних в колонці "Height" для групи CO становить W = 0,982, p = 0,389, а для групи PD становить W = 0,989, p = 0,672. Враховуючи, що р \> 0,05, то можна стверджувати, що для розподілу значень в обох групах нормальний розподіл даних.

Враховуючи, що дані розподілені нормально, порівнюємо дисперсії в двох групах використовуючи тест Левене:

```{r}
leveneTest(Height ~ Group, data = L3)
```

В результаті проведення тесту Левене для порівняння дисперсій в двох групах. Було виявлено, що F = 0,091, p = 0,763. Враховуючи, що p \> 0,05, то ми приймаємо нульову гіпотезу та приходимо до висновку, що немає різниці між дисперсіями між двома групами.

Таким чином, порівняння двох груп ми можемо проводити з використанням t-тесту:

```{r}
t.test(Height ~ Group, data = L3, var.equal = TRUE)
```

Відповідно до результатів тесту Cтьюдента, t = 0,584, p = 0,559. Враховуючи, що р \> 0,05, то нульову гіпотезу про те, що дані не мають статистично значимої різниці не мають не відкидаємо, а отже статистично значимої різниці між групами CO та PD для показника "Height" немає.

## TUAG

Спочатку було описано дані для двох груп:

```{r}
summary(L3$TUAG[L3$Group == 'CO'])
```

```{r}
summary(L3$TUAG[L3$Group == 'PD'])
```

Також обрахували стандартне відхилення:

```{r}
sd(L3$TUAG[L3$Group == 'CO'], na.rm = TRUE)
```

```{r}
sd(L3$TUAG[L3$Group == 'PD'], na.rm = TRUE)
```

Потім дані було представлено графічно з використанням density plot а також "ящика з вусиками".

```{r}
ggplot(L3, aes(x = Group, y = TUAG)) +
    geom_boxplot() +
    labs(title = "Distribution of TUAG in CO and PD",
         x = "Group",
         y = "TUAG")
```

Враховуючи велику кількість значень, що вибиваються, в групі PD, то припускаю, що там буде ненормальний розподіл.

```{r}
ggplot(L3, aes(x = TUAG, fill = Group)) +
    geom_density(alpha = 0.7) +
    labs(title = "Density Plot of TUAG in CO and PD",
         x = "TUAG",
         y = "Density")

```

На основі цього графіку можна висловити припущення, що між даними в групах існує статистично значима різниця.

Далі, для того, щоб дізнатися чи наші дані розподілені нормально, було проведено тест Шапіро-Вілка:

```{r}
shapiro.test(L3$TUAG[L3$Group=='CO'])
```

```{r}
shapiro.test(L3$TUAG[L3$Group=='PD'])
```

У результаті проведення тесту Шапіро-Вілка було виявлено, що для стовпчика "TUAG" групи СО W = 0,964, р = 0,069, тоді як для групи PD - W = 0,699, р = 2,829е-12. Враховуючи, що ми приймаємо нульову гіпотезу щодо нормальності розподілу даних за p ≥ 0,05, можна стверджувати, що в даних для групи CO нормальний розподіл присутній, на відмінну від групи PD.

Враховуючи, що в одній з груп дані не були нормально розподілені, використовуємо непараметричний метод для незалежних порівнянь двох вибірок, а саме тест Манна-Вітні, який є модифікацією тесту Вілкоксона:

```{r}
wilcox.test(TUAG ~ Group, data = L3, paired = FALSE)
```

Відповідно до результатів тесту Манна-Вітні, W = 1122, p = 2,172е-10. Враховуючи, що р\<0,05, то нульову гіпотезу про те, що дані не мають статистично значимої різниці не мають відкидаємо, а отже статистично значима різниці між групами CO та PD для показника "TUAG" є .

## Швидкість

```{r}
summary(L3$Speed01[L3$Group == 'CO'])
```

```{r}
summary(L3$Speed01[L3$Group == 'PD'])
```

```{r}
sd(L3$Speed01[L3$Group == 'CO'], na.rm = TRUE)
```

```{r}
sd(L3$Speed01[L3$Group == 'CO'], na.rm = TRUE)
```

Спочатку дані було представлено графічно з використанням density plot а також "ящика з вусиками".

```{r}
ggplot(L3, aes(x = Group, y = Speed01)) +
    geom_boxplot() +
    labs(title = "Distribution of Speed in CO and PD",
         x = "Group",
         y = "Speed, m/sec")
```

Припускаю, що тут та ж сама ситуація, що і з показником TUAG для групи PD - багато значень вибиваються (забула як вони називаються, якщо чесно), тому можливо розподіл буде тут ненормальним.

```{r}
ggplot(L3, aes(x = Speed01, fill = Group)) +
    geom_density(alpha = 0.7) +
    labs(title = "Density Plot of Speed in CO and PD",
         x = "Speed, m/sec",
         y = "Density")
```

На основі денсіті плоту висловлюю припущення, що статистично значиму різницю ми тут побачимо.

Далі, для того, щоб дізнатися чи наші дані розподілені нормально, було проведено тест Шапіро-Вілка:

```{r}
shapiro.test(L3$Speed01[L3$Group=='CO'])
```

```{r}
shapiro.test(L3$Speed01[L3$Group=='PD'])
```

Відповідно до результатів тесту, критерій, обрахований на основі даних в колонці "Speed01" для групи CO становить W = 0,982, p = 0,427, а для групи PD становить W = 0,958, p = 0,005. Враховуючи, що р ≤ 0,05, то можна стверджувати, що для розподілу значень в групі CO нормальний розподіл, тоді як для групи PD нормальний розподіл даних не притаманний.

Враховуючи, що в одній з груп дані не були нормально розподілені, використовуємо непараметричний метод для незалежних порівнянь двох вибірок, а саме тест Манна-Вітні, який є модифікацією тесту Вілкоксона:

```{r}
wilcox.test(Speed01 ~ Group, data = L3, paired = FALSE)
```

Відповідно до результатів тесту Манна-Вітні, W = 5235, p = 7,436е-10. Враховуючи, що р\<0,05, то нульову гіпотезу про те, що дані не мають статистично значимої різниці не мають відкидаємо, а отже статистично значима різниці між групами CO та PD для показника "Speed" є.

## Результати та висновки зроблені під час роботи

-   Представлено дані 166 осіб, що поділено на 2 групи: контрольна (СО, 93 особи) та хворі на хворобу Паркінсона (PD, 73 особи);

-   Середній показник зросту для групи СО становить 1,68±0,08 м, тоді як групи PD - 1,67±0,08 м. Відповідно до результатів тесту Шапіро-Вілка, критерій, обрахований на основі даних в колонці "Height" для групи CO становить W = 0,982, p = 0,389, а для групи PD становить W = 0,989, p = 0,672. Враховуючи, що р \> 0,05, то можна стверджувати, що для розподілу значень в обох групах нормальний розподіл даних. В результаті проведення тесту Левене для порівняння дисперсій в двох групах було виявлено, що F = 0,091, p = 0,763. Враховуючи, що p \> 0,05, то ми приймаємо нульову гіпотезу та приходимо до висновку, що немає різниці між дисперсіями між двома групами. Відповідно до результатів тесту Cтьюдента, t = 0,584, p = 0,559. Враховуючи, що р \> 0,05, то нульову гіпотезу про те, що дані не мають статистично значимої різниці не мають не відкидаємо, а отже статистично значимої різниці між групами CO та PD для показника "Height" немає;

-   Середній показник TUAG для групи CO cтановить 9,29±1,59 c, тоді як медіанний - 9,20[8,19;10,02] c. Медіанний показник TUAG для PD становить 11,12[10,12;12,97] c. У результаті проведення тесту Шапіро-Вілка було виявлено, що для стовпчика "TUAG" групи СО W = 0,964, р = 0,069, тоді як для групи PD - W = 0,699, р = 2,829е-12. Враховуючи, що ми приймаємо нульову гіпотезу щодо нормальності розподілу даних за p ≥ 0,05, можна стверджувати, що в даних для групи CO нормальний розподіл присутній, на відмінну від групи PD. Відповідно до результатів тесту Манна-Вітні, W = 1122, p = 2,172е-10. Враховуючи, що р\<0,05, то нульову гіпотезу про те, що дані не мають статистично значимої різниці не мають відкидаємо, а отже статистично значима різниці між групами CO та PD для показника "TUAG" є.

-   Cередній показник швидкості для групи СО становить 1,24±0,16 м/сек, тоді як медіанний - 1,24[1,13;1,34] м/сек. Медіанний показник швидкості становить 1,07[0,90;1,18] м/сек. Відповідно до результатів тесту, критерій, обрахований на основі даних в колонці "Speed01" для групи CO становить W = 0,982, p = 0,427, а для групи PD становить W = 0,958, p = 0,005. Враховуючи, що р ≤ 0,05, то можна стверджувати, що для розподілу значень в групі CO нормальний розподіл, тоді як для групи PD нормальний розподіл даних не притаманний. Відповідно до результатів тесту Манна-Вітні, W = 5235, p = 7,436е-10. Враховуючи, що р\<0,05, то нульову гіпотезу про те, що дані не мають статистично значимої різниці не мають відкидаємо, а отже статистично значима різниці між групами CO та PD для показника "Speed" є.

# Завдання 4

Для початку було імпортовано таблицю, що містить спрощені назви в першому рядку та змінений тип даних на "numeric" в стовпчиках, які цього потребують.

```{r}
library(readxl)
L4 <- read_excel("D:/work_biph/phd/study/stat/L4.xlsx", 
    col_types = c("numeric", "numeric", "text", 
        "numeric", "numeric", "numeric", 
        "numeric", "text"))
View(L4)
```

Загалом представлено дані 50 осіб, що поділено на 3 групи: Young (11 осіб), Middle (20 осіб), Old (12 осіб). Для 7 осіб група не була визначена. Особи з невизначеною групою мали вік в діапазонах 61-68 місяців та 101-130 місяців. Для даних осіб аналіз не було проведено.

Потім було замінено одиниці в стовпчиках height, weight та leglength в одиниці CI, тобто з inches, lb, inches в метри, кілограми та метри відповідно наступним чином:

```{r}
L4$height <- L4$height*0.0254
L4$leglength <- L4$leglength*0.0254
L4$weight <- L4$weight*0.4536
```

## Height

Спочатку було проаналізовано дані для показнику в різних групах наступним чином:

```{r}
print(summary_by_height <- L4 %>%
        group_by(group) %>%
        summarise(across(starts_with("height"), list(
          Mean = ~ mean (., na.rn = TRUE),
          Median = ~ median (., na.rn = TRUE),
          SD = ~ sd(., na.rm = TRUE),
          SEM = ~ sd(., na.rm = TRUE) / sqrt(sum(!is.na(.))),
          Q1 = ~ quantile(., 0.25, na.rm = TRUE),
          Q2 = ~ quantile(., 0.75, na.rm = TRUE),
          Total_count = ~sum(!is.na(.)),
          Min = ~ min(., na.rm = TRUE),
          Max = ~ max(., na.rm = TRUE)
        ))))
```

```{r}
ggplot(L3, aes(x = factor(Group, levelc = c('Young', 'Middle', 'Old')), y = Height)) +
    geom_boxplot() +
    labs(title = "Distribution of Height in Young, Middle, Old",
         x = "Group",
         y = "Height, m")
```

Далі було визначено чи нормально розподілені дані для цього показника в групах. Для цього було створено формулу:

```{r}
shapiro_test_by_group <- function(data) {
  shapiro_results <- shapiro.test(data)
  return(shapiro_results)
}
```

### Тест Шапіро-Вілка

Надалі було проведено тест Шапіро-Вілка для визначення нормальності:

```{r}
tapply(L4$height, L4$group, shapiro_test_by_group)
```

#### Young

В результаті теста Шапіро-Вілка було визначено, що критерій W становить 0,89, р = 0,12. Оскільки p \> 0,05, то дані в даній групі для даного показника є нормально розподіленими.

Для даної групи показник зросту варіює в проміжку 1,00-1,14 см, середнє значення становить 1,05±0,50 м, стандартна похибка - 0,02. Медіанне значення становить 1,03[1,02; 1,07] м.

#### Middle

В результаті теста Шапіро-Вілка було визначено, що критерій W становить 0,86, р = 0,01. Оскільки p \< 0,05, то дані в даній групі для даного показника є ненормально розподіленими.

Для даної групи показник зросту варіює в проміжку 1,07-1,32 м, медіанне значення становить 1,27[1,22; 1,30] м.

#### Old

В результаті теста Шапіро-Вілка було визначено, що критерій W становить 0,92, р = 0,27. Оскільки p \> 0,05, то дані в даній групі для даного показника є нормально розподіленими.

Для даної групи показник зросту варіює в проміжку 1,40-1,78 м, середнє значення становить 1,55±0,10 м, стандартна похибка - 0,02. Медіанне значення становить 1,03[1,49; 1,63] м.

### Тест Левене

Далі було проведено тест Левене для дослідження гомогенності варіанс в різних групах наступним чином:

```{r}
leveneTest(height ~ group, data = L4)
```

Оскільки p \> 0,05, то варіанси в групах рівнозначні.

### Вибір однофакторного багатовибіркового тесту

Тест Шапіро-Вілка, нормальність: + - +

Тест Левене, гомогенність вибірок: +

Виявлено ненормальний розподіл - примінюємо непараметричний метод.

Виявлено гомогенність вибірок - для порівняння трьох незалежних груп застосовуємо критерій Краскела-Воліса. Він ґрунтується на рангах, а тому нечутливий до порушення нормальності розподілу.

### Критерій Краскера-Воліса

Враховуючи все вищезазначене проводимо тест Краскера-Воліса наступним чином:

```{r}
kruskal.test(height~group, data = (L4))
```

Оскільки p\<0,05, то щонайменше одна група значно відрізняється від інших.

Враховуючи це, проводимо post hoc порівняння:

```{r}
pairwise.wilcox.test(L4$height, L4$group, p.adjust.method = 'holm')
```

#### Old - Middle

Різниця між даними групами є статистично значимою на рівні 9,2\*10\^(-06). Враховуючи, що p\<0,05, то різниця між даними групами є статистично значущою.

#### Young - Middle

Різниця між даними групами є статистично значимою на рівні 2,1\*10\^(-05). Враховуючи, що p\<0,05, то різниця між даними групами є статистично значущою.

#### Young - Old

Різниця між даними групами є статистично значимою на рівні 5,3\*10\^(-05). Враховуючи, що p\<0,05, то різниця між даними групами є статистично значущою.

## Weight

Спочатку було проаналізовано дані для показнику в різних групах наступним чином:

```{r}
print(summary_by_weight <- L4 %>%
        group_by(group) %>%
        summarise(across(starts_with("weight"), list(
          Mean = ~ mean (., na.rn = TRUE),
          Median = ~ median (., na.rn = TRUE),
          SD = ~ sd(., na.rm = TRUE),
          SEM = ~ sd(., na.rm = TRUE) / sqrt(sum(!is.na(.))),
          Q1 = ~ quantile(., 0.25, na.rm = TRUE),
          Q2 = ~ quantile(., 0.75, na.rm = TRUE),
          Total_count = ~sum(!is.na(.)),
          Min = ~ min(., na.rm = TRUE),
          Max = ~ max(., na.rm = TRUE)
        ))))
```

```{r}
ggplot(L3, aes(x = factor(group, levelc=c('Young', 'Middle', 'Old')), y = weight)) +
+    geom_boxplot() +
+    labs(title = "Distribution of Height in Young, Middle, Old",
+         x = "Group",
+         y = "Weight, kg")
```

### Тест Шапіро-Вілка

Далі було проведено тест Шапіро-Вілка для визначення нормальності:

```{r}
tapply(L4$weight, L4$group, shapiro_test_by_group)
```

#### Young

В результаті теста Шапіро-Вілка було визначено, що критерій W становить 0,93, р = 0,43. Оскільки p \> 0,05, то дані в даній групі для даного показника є нормально розподіленими.

Для даної групи показник ваги варіює в проміжку 13,60-22,70 кг, середнє значення становить 17,20±2,43 кг, стандартна похибка - 0,73. Медіанне значення становить 16,80[15,90; 18,40] кг.

#### Middle

В результаті теста Шапіро-Вілка було визначено, що критерій W становить 0,98, р = 1,00. Оскільки p \> 0,05, то дані в даній групі для даного показника є нормально розподіленими.

Для даної групи показник ваги варіює в проміжку 17,70-34,00 кг, середнє значення становить 25,20±4,10 кг, стандартна похибка - 0,92, медіанне значення становить 24,90[22,50; 27,40] кг.

#### Old

В результаті теста Шапіро-Вілка було визначено, що критерій W становить 0,81, р = 0,01. Оскільки p \< 0,05, то дані в даній групі для даного показника є ненормально розподіленими.

Для даної групи показник ваги варіює в проміжку 36,30-64,9 кг, медіанне значення становить 40,60[37,80; 48,20] кг.

### Тест Левене

Далі було проведено тест Левене для дослідження гомогенності варіанс в різних групах наступним чином:

```{r}
leveneTest(weight ~ group, data = L4)
```

Оскільки p\<0,05, то присутня статистично значима різниця між варіансами груп.

### Вибір однофакторного багатовибіркового тесту

Тест Шапіро-Вілка, нормальність: + + -

Тест Левене, гомогенність вибірок: -

Виявлено ненормальний розподіл - використовуємо непараметричний метод.

Виявлено відсутність гетерогенності вибірок - використовуємо непараметричний post hoc тест - тест Коновера-Імана дозволяє провести усі можливі попарні порівняння, зазначити необхідний метод корекції p та навіть одночасно виконати тест Краскела-Воліса

### Тест Коновера-Імана

Cпочатку додали можливість проводити тест так як вказано за посиланням: <https://github.com/cran/conover.test/blob/master/R/conover.test.R>

```{r}
  # version 1.1.6 April 9, 2024 by alexis.dinno@pdx.edu
  # perform Conover-Iman test of multiple comparisons using rank sums

p.adjustment.methods <- c("none","bonferroni","sidak","holm","hs","hochberg","bh","by")

conover.test <- function(x=NA, g=NA, method=p.adjustment.methods, kw=TRUE, label=TRUE, wrap=FALSE, table=TRUE, list=FALSE, rmc=FALSE, alpha=0.05, altp=FALSE) {

  # FUNCTIONS

  # kwallis.test: a custom Kruskal Wallis test function to support conover.test
  # Note: does not currently play nicely with missing values.
  kwallis.test <- function(x=NA,g=NA,pass=0) {
    # FUNCTIONS
    # tiedranks: enumerates tied values from a vector of ranks
    # ranks: a vector of rank values
    # returns: ties, a vector of values that are tied
    tiedranks <- function(ranks) {
      ranks <- sort(ranks)
      #enumerate tied values
      ties <- c()
      for (i in 2:length(ranks)) {
        if (ranks[i-1] == ranks[i]) {
          if (length(ties) > 0) {
            if (ranks[i-1] != tail(ties,n=1)) {
              ties <- c(ties,ranks[i-1])
              }
            }
           else {
            ties <- c(ranks[i-1])
            }
          }
        }
      return(ties)
      }

    #set up data by lists
    if (is.list(x)) {
      N <- 0
      for (i in 1:length(x)) {
        N <- N + length(x[[i]])
        }
      Data <- matrix(NA,N,4)
      for (i in 1:N) {
        Data[i,1] <- i
        }
      obs <- c()
      group <- c()
      for (i in 1:length(x)) {
        obs <- c(obs,x[[i]])
        group <- c(group,rep(i,length(x[[i]])))
        }
      Data[,2] <- obs
      if (length(g) > 1) {
        Data[,3] <- g
        }
       else {
        Data[,3] <- group        
        }
      Data[,4] <- rank(Data[,2], ties.method="average", na.last=NA)
      }
  
    #set up data by groups
    if (!is.list(x)) {
      N <- length(x)
      Data <- matrix(NA,length(x),4)
      Data[,1] <- 1:length(x)
      Data[,2] <- x
      Data[,3] <- g
      Data[,4] <- rank(Data[,2], ties.method="average", na.last=NA)
      }
    k <- length(unique(Data[,3]))
  
    #calculate ties adjustment
    ranks <- Data[,4]
    ranks <- ranks[!is.na(ranks)]
    ties <- tiedranks(ranks)
    r <- length(ties)
    tiesadj <- 0
    if (r > 0) {
      for (s in 1:r) {
        tau <- sum(ranks==ties[s])
        tiesadj <- tiesadj + (tau^{3} - tau)
        }
      }
    tiesadj <- 1-(tiesadj/((N^3) - N))
  
    #calculate H
    ranksum <- 0
    for (i in 1:k) {
      ranksum <- ranksum + ((sum(Data[,4][Data[,3]==i]))^2)/(sum(Data[,3]==i))
      }
    H  <- ((12/(N*(N+1)))*ranksum - 3*(N+1))/tiesadj
    df <- k-1
    p  <- pchisq(H,k-1,lower.tail=FALSE)
  
    #present output
    output <- paste("Kruskal-Wallis chi-squared = ",round(H,digits=4),", df = ",df,", p-value = ",round(p,digits=2),"\n\n" ,sep="")
  
    invisible(list(output=output,H=H,df=df,p=p,N=N,Data=Data,data.name=data))
    }

  # all.integers robustly tests whether all elements of a vector are integers
  all.integers <- function(x) {
    for (i in length(x)) {
      if (is.na(x[i]) | is.list(x[i]) | length(x[i]) > 1 | !is.numeric(x[i])) {
        return(FALSE)
        }
      if (x[i]%%1!=0) {
        return(FALSE)
        }
      }
    return(TRUE)
    }

  # tpad: returns the pad string, n times, defaulting to spaces
  # n: a number of replications; pad: string to replicate
  tpad <- function(n=1, pad=" ") {
    if (n == 0) {
      return("")
      }
    return( paste0(rep(x=pad,times=n),collapse="") )
    }

  # tformat: formats t values for display in table
  # t: a real t-value
  # returns: a formatted string
  tformat <- function(t) {
    if (t < 0) {
      sign <- "-"
      }
     else {
       sign <- " "
       }
     leftspaces <- max(2,floor(log10(abs(t)))+2)
     leftdigits <- floor(abs(t))
     rightspaces <- 8 - leftspaces
     rightdigits <- substr(paste0(abs(t) - floor(abs(t)),"00000000"),3,rightspaces+2)
     return(paste0(sign,leftdigits,".",rightdigits))
    }

  # pformat: formats p values for display in table
  # p: a real p-value
  # returns: a formatted string
  pformat <- function(p) {
     if (p == 1) {
       return("1.0000")
       }
      else {
       rightspaces <- 4
       rightdigits <- substr(paste0(sprintf("%1.4f",p),"000000000"),3,rightspaces+2)
       return(paste0("0.",rightdigits))
       }
    }

  # centertext: centers a string within a specific width
  centertext <- function(text,width=80,lmargin=2,rmargin=2) {
    textwidth <- nchar(text)
    if (textwidth <= width-lmargin-rmargin) {
      text <- substr(text,1,width-lmargin-rmargin)
      }
    buff <- (width-lmargin-rmargin-textwidth)
    if (buff%%2 == 0) {
      return(paste(paste(rep(" ",buff/2),collapse=""),text,paste(rep(" ",buff/2),collapse=""),"\n",collapse=""))
      }
     else {
      return(paste(paste(rep(" ",1+(buff-1)/2),collapse=""),text,paste(rep(" ",(buff-1)/2),collapse=""),"\n",collapse=""))
      }
    }

  # conovertestheader: displays the Conover-Iman test table headers.
  conovertestheader <- function(groupvar,colstart,colstop,rmc) {
    if (rmc==FALSE) {
      cat("Col Mean-|\nRow Mean |")
      }
     else {
      cat("Row Mean-|\nCol Mean |")
      }
    groupvalues  <- levels(factor(groupvar))
    for (col in colstart:colstop) {
      vallab  <- substr(groupvalues[col],1,8)
      pad     <- 8-nchar(vallab)
      colhead <- paste0(tpad(n=pad),vallab)
      cat(paste0("   ",substr(colhead,1,8)),sep="")
      }
    cat("\n")  
    separatorlength = 10 + 11*(colstop-colstart)+1
    cat(tpad(n=9,pad="-"),"+",tpad(n=separatorlength,pad="-"),"\n",sep="")
    }

  # conovertestttable displays the Conover-Iman test t values
  conovertestttable <- function(groupvar, index, Tvalues, colstart, colstop) {
    groupvalues  <- levels(factor(groupvar))

    # Row headers
    vallab  <- substr(groupvalues[index],1,8)
    pad     <- 8-nchar(vallab)
    rowhead <- paste0(tpad(n=pad),vallab)
    cat(paste0(rowhead," |"))

    # Table t entries
    for (i in colstart:colstop) {
      t <- Tvalues[(((index-2)*(index-1))/2) + i]
      cat(paste0("  ",tformat(t)))
      }
    cat("\n")
    }

  # conovertestptable: displays the Conover-Iman test p values
  conovertestptable <- function(index, P, colstart, colstop, Reject,last) {
    # Blank row header
    cat("         |")

    # Table p entries
    for (i in colstart:colstop) {
      p <- P[(((index-2)*(index-1))/2) + i]
      if ( Reject[(((index-2)*(index-1))/2) + i] == 0) {
        cat(paste0("     ",pformat(p)),sep="")
        }
       else {
        cat(paste0("    ",pformat(p)),"*",sep="")
        }
      }
    cat("\n")

    # Close out with another blank row header
    if (last == 0) {
      cat("         |\n") 
      }
    }
    
  # alphabetize.factor: alphabetizes a factor
  # this is very quick and dirty with no checking.
  alphabetize.factor <- function(x) {
    return(factor(sort(c(as.character(x)))))
    }


  # VALIDATIONS & PREPARATIONS
  # names for output
  xname <- paste(if(is.name(substitute(x))) {deparse(substitute(x))} else {"x"})
  gname <- paste(if(is.name(substitute(g))) {deparse(substitute(g))} else {"group"})
  xaslist <- is.list(x)
  tempg <- 1:length(x)
  
  # casewise deletion of missing data
  if (length(g) > 1) {
    if (label==TRUE) {
      if (is.factor(g)) {
        glevels <- levels(g)
        }
       else {
       	g <- factor(g)
        glevels <- levels(g)
        }
      }
     else {
      glevels <- names(table(addNA(g, ifany = TRUE)))
      }
    Data <- data.frame(x,g)[order(levels(g)[c(g)]),]
    Data <- Data[!is.na(unlist(Data$x)),]
    Data <- Data[!is.na(Data$g),]
    x <- Data[,1]
	g <- alphabetize.factor(Data$g)
    }
   else {
     g <- c()
     for (i in 1:length(x)) {
       for (j in 1:length(x[[i]])) {
         g <- c(g,i)
         }
       }
    x <- as.numeric(unlist(x)[!is.na(unlist(x))])
    }
  # validate method
  if (length(method) > 1) {
    method <- "none"
    }
    
  if (tolower(method) != "none" & tolower(method) != "bonferroni" & tolower(method) != "sidak" & tolower(method) != "holm" & tolower(method) != "hs" & tolower(method) != "hochberg" & tolower(method) != "bh" & tolower(method) != "by") {
    stop("method must be one of: none, bonferroni, sidak, hs, bh, or by")
    }

  if (tolower(method)=="none") {
    Name <- "(No adjustment)"
    }
  if (tolower(method)=="bonferroni") {
    Name <- "(Bonferroni)"
    }
  if (tolower(method)=="sidak") {
    Name <- "(\u0160id\u00E1k)"
    }
  if (tolower(method)=="holm") {
    Name <- "(Holm)"
    }
  if (tolower(method)=="hs") {
    Name <- "(Holm-\u0160id\u00E1k)"
    }
  if (tolower(method)=="hochberg") {
    Name <- "(Hochberg)"
    }
  if (tolower(method)=="bh") {
    Name <- "(Benjamini-Hochberg)"
    }
  if (tolower(method)=="by") {
    Name <- "(Benjamini-Yekuteili)"
    }

  # validate that x is longer than 1
  if (length(unlist(x))==1) {
    stop("too few observations in x.")
    }
  # validate that x is a numeric vector of data values, or a list of numeric 
  # data vectors, and is not NA
  if (TRUE %in% is.na(unlist(x)) | !is.vector(unlist(x), mode="numeric") ) {
    stop("x must contain a numeric vector of data values, or a list of numeric data vectors.")
    }
  # validate that g is not missing if x is a vector
  if (!xaslist & TRUE %in% is.na(g) ) {
    stop("when specifying x as a vector, you must include g.")
    }
  # validate that g is not NA
  if (length(g) > 1 & TRUE %in% is.na(g)) {
    stop("g must have no missing values.")
    }
  # validate that g is factor or vector.
  if (length(g) > 1 & ( !is.factor(g) & !is.vector(g) ) ) {
    
    stop("g must be a factor, character vector, or integer vector.")
    }
  # validate that g is a vector of mode = character or mode = integer.
  if (length(g) > 1 & is.vector(g) ) {
    if ( !is.vector(g, mode="character") & !all.integers(g) ) {
      stop("g must be a factor, character vector, or integer vector.")
      }
    }

  # CALCULATIONS
  out <- NULL
  if (xaslist & length(g)==1) {
    kwallis.test(x, 1:length(x), pass=1) -> out
    }
  if (length(g)>1 & xaslist) {
    kwallis.test(x, g, pass=1) -> out
    }
  if (length(g)>1 & !xaslist) {
    kwallis.test(x, g, pass=0) -> out
    }

  if (kw==TRUE) {
    cat("  Kruskal-Wallis rank sum test\n\ndata: ",xname," and ",gname,"\n",sep="")
    cat(out$output)
    }
    chi2    <- out$H
    k       <- out$df + 1
    N       <- out$N
    Data    <- out$Data
    m       <- k*(k-1)/2
    Tvalues <- rep(0,m)
    P       <- rep(0,m)
    nu      <- N - k

    # calculate pooled variance to be used in generating t statistics
    ranks   <- Data[,4]
    varA  <- 1/(N-1)
    varB  <- 0
    for (i in 1:N) {
      varB <- varB + ranks[i]^2
      } 
    varB <- varB - (N*(((N+1)^2)/4))
    S2 <- varA*varB

    # Calculate t test statistics
    for (i in 2:k) {
      for (j in 1:(i-1)) {
        ni <- sum(Data[,3]==i)
        nj <- sum(Data[,3]==j)
        meanranki <- mean(Data[,4][Data[,3]==i])
        meanrankj <- mean(Data[,4][Data[,3]==j])
        if (rmc == FALSE) {
          t <- (meanrankj-meanranki)/(sqrt(S2*((N-1-chi2)/(N-k)))*sqrt(1/nj + 1/ni))
          }
        if (rmc == TRUE) {
          t <- (meanranki-meanrankj)/(sqrt(S2*((N-1-chi2)/(N-k)))*sqrt(1/nj + 1/ni))
          }
        index <- ((i-2)*(i-1)/2) + j
        Tvalues[index] <- t
        }
      }

  # Calculate p-values for t statistics, and adjust as needed
  # If p = P(T >= |t|)
  if (altp==FALSE) {
    P <- pt(q=abs(Tvalues), df=nu, lower.tail=FALSE)
    }
   # Otherwise, if p = P(|T| >= |t|)
   else {
    P <- 2*pt(q=abs(Tvalues), df=nu, lower.tail=FALSE)
   	}
  
  #calculate adjusted p-values based on method argument
  Reject <- rep(0,m)
  # No adjustment for multiple comparisons
  if (tolower(c(method))=="none") {
    P.adjust <- P
    # If p = P(T >= |t|)
    if (altp==FALSE) {
      Reject <- P.adjust <= alpha/2
      }
     # Otherwise, if p= P(|T| >= |t|)
     else {
      Reject <- P.adjust <= alpha
      }
    }

  # Control FWER using (Dunn's) Bonferroni
  if (tolower(c(method))=="bonferroni") {
    P.adjust <- pmin(1,P*m)
    # If p = P(T >= |t|)
    if (altp==FALSE) {
      Reject <- P.adjust <= alpha/2
      }
     # Otherwise, if p= P(|T| >= |t|)
     else {
      Reject <- P.adjust <= alpha
      }
    }

  # Control FWER using Šidák
  if (tolower(c(method))=="sidak") {
    P.adjust <- pmin(1,1 - (1-P)^m)
    # If p = P(T >= |t|)
    if (altp==FALSE) {
      Reject <- P.adjust <= alpha/2
      }
     # Otherwise, if p= P(|T| >= |t|)
     else {
      Reject <- P.adjust <= alpha
      }
    }

  # Control FWER using Holm(-Bonferroni)
  if (tolower(c(method))=="holm") {
    Psort <- matrix(c(P,1:m,rep(0,m)),3,m,byrow=TRUE)
    Psort <- Psort[,order(Psort[1,])]
    for (i in 1:m) {
      adjust <- m+1-i
      Psort[1,i] <- pmin(1,Psort[1,i]*adjust)
      # If p = P(T >= |t|)
      if (altp==FALSE) {
        if (i==1) {
          Psort[3,i] <- Psort[1,i] <= alpha/2
          }
         else {
          Psort[3,i] <- ((Psort[1,i] <= alpha/2) & Psort[3,i-1] != 0)
          }
        }
       # Otherwise, if p = P(|T| >= |t|)
       else {
        if (i==1) {
          Psort[3,i] <- Psort[1,i] <= alpha
          }
         else {
          Psort[3,i] <- ((Psort[1,i] <= alpha) & Psort[3,i-1] != 0)
          }
        }
      }
    Psort <- Psort[,order(Psort[2,])]
    P.adjust <- Psort[1,]
    Reject <- Psort[3,]
    }

  # Control FWER using Holm-Šidák
  if (tolower(c(method))=="hs") {
    Psort <- matrix(c(P,1:m,rep(0,m)),3,m,byrow=TRUE)
    Psort <- Psort[,order(Psort[1,])]
    for (i in 1:m) {
      adjust <- m+1-i
      Psort[1,i] <- pmin(1,(1 - ((1 - Psort[1,i])^adjust)))
      # If p = P(T >= |t|)
      if (altp==FALSE) {
        if (i==1) {
          Psort[3,i] <- Psort[1,i] <= alpha/2
          }
         else {
          Psort[3,i] <- ((Psort[1,i] <= alpha/2) & Psort[3,i-1] != 0)
          }
        }
       # Otherwise, if p = P(|T| >= |t|)
       else {
        if (i==1) {
          Psort[3,i] <- Psort[1,i] <= alpha
          }
         else {
          Psort[3,i] <- ((Psort[1,i] <= alpha) & Psort[3,i-1] != 0)
          }
        }
      }
    Psort <- Psort[,order(Psort[2,])]
    P.adjust <- Psort[1,]
    Reject <- Psort[3,]
    }

  # Control FWER using Hochberg
  if (tolower(c(method))=="hochberg") {
    Psort <- matrix(c(P,1:m,rep(0,m)),3,m,byrow=TRUE)
    Psort <- Psort[,order(Psort[1,], decreasing=TRUE)]
    for (i in 1:m) {
      adjust <- i
      Psort[1,i] <- min(1,Psort[1,i]*adjust)
      # If p = P(T >= |t|)
      if (altp==FALSE) {
        if (i==1) {
          Psort[3,i] <- Psort[1,i] <= alpha/2
          }
         else {
          Psort[3,i] <- ((Psort[1,i] <= alpha/2) | Psort[3,i-1] == 1)
          }
        }
       # Otherwise, if p = P(|T| >= |t|)
       else {
        if (i==1) {
          Psort[3,i] <- Psort[1,i] <= alpha
          }
         else {
          Psort[3,i] <- ((Psort[1,i] <= alpha) | Psort[3,i-1] == 1)
          }
        }
      }
    Psort <- Psort[,order(Psort[2,])]
    P.adjust <- Psort[1,]
    Reject <- Psort[3,]
    }

  # Control FDR using Benjamini-Hochberg
  if (tolower(c(method))=="bh") {
    Psort <- matrix(c(P,1:m,rep(0,m)),3,m,byrow=TRUE)
    Psort <- Psort[,order(Psort[1,], decreasing=TRUE)]
    for (i in 1:m) {
      adjust <- (m/(m+1-i))
      Psort[1,i] <- min(1,Psort[1,i]*adjust)
      # If p = P(T >= |t|)
      if (altp==FALSE) {
        if (i==1) {
          Psort[3,i] <- Psort[1,i] <= alpha/2
          }
         else {
          Psort[3,i] <- ((Psort[1,i] <= alpha/2) | Psort[3,i-1] == 1)
          }
        }
       # Otherwise, if p = P(|T| >= |t|)
       else {
        if (i==1) {
          Psort[3,i] <- Psort[1,i] <= alpha
          }
         else {
          Psort[3,i] <- ((Psort[1,i] <= alpha) | Psort[3,i-1] == 1)
          }
        }
      }
    Psort <- Psort[,order(Psort[2,])]
    P.adjust <- Psort[1,]
    Reject <- Psort[3,]
    }

  # Control FDR using Benjamini-Yekuteili
  if (tolower(c(method))=="by") {
    Psort <- matrix(c(P,1:m,rep(0,m)),3,m,byrow=TRUE)
    Psort <- Psort[,order(Psort[1,], decreasing=TRUE)]
    for (i in 1:m) {
      adjust <- (m/(m+1-i))*sum(1/(1:m))
      Psort[1,i] <- min(1,Psort[1,i]*adjust)
      # If p = P(T >= |t|)
      if (altp==FALSE) {
        if (i==1) {
          Psort[3,i] <- Psort[1,i] <= alpha/2 # reverse sorted, so m-i+1, rather than i
          }
         else {
          Psort[3,i] <- ((Psort[1,i] <= alpha/2) | Psort[3,i-1] == 1)
          }
        }
       # Otherwise, if p = P(|T| >= |t|)
       else {
        if (i==1) {
          Psort[3,i] <- Psort[1,i] <= alpha
          }
         else {
          Psort[3,i] <- ((Psort[1,i] <= alpha) | Psort[3,i-1] == 1)
          }
        }
      }
    Psort <- Psort[,order(Psort[2,])]
    P.adjust <- Psort[1,]
    Reject <- Psort[3,]
    }

  # OUTPUT
  cat("\n")
  if (table==TRUE | list==TRUE) {
    if ((TRUE %in% is.na(g))) {
      title <- paste("Comparison of ",xname," across ",k," groups",sep="")
      }
     else {
      title <- paste("Comparison of ",xname," by ",gname,sep="")
      }
    cat(centertext(title))
    cat(centertext(Name))
    }

  if (table==TRUE) {
    # Need to determine how many tables (reps) to output
    reps      <- floor((k-1)/6)
    laststart <- (reps*6) + 1
    kminusone <- k - 1
    if (label==FALSE) {
      g <- as.numeric(g)
      }
    if (length(g)==1) {
      g <- 1:k
      }
  
    # Replication loop for >7 groups, no wrap
    if (wrap==FALSE) {
      if (k > 7) {
        for (rep in 1:reps) {
          colstart <- (6*rep)-5
          colstop  <- 6*rep
          conovertestheader(g,colstart,colstop,rmc)
          # Table body
          for (i in (colstart+1):k) {
            colstop <- min(i-1,6*rep)
            conovertestttable(g,i,Tvalues,colstart,colstop)
            if (i < k) {
              conovertestptable(i,P.adjust,colstart,colstop,Reject,0)
              }
             else {
              conovertestptable(i,P.adjust,colstart,colstop,Reject,1)
              }
            }
          }
        # End of table
        if (laststart < k) {
          conovertestheader(g,laststart,kminusone,rmc)
          # Table body
          for (i in (laststart+1):k) {
          	colstop <- i-1
            conovertestttable(g,i,Tvalues,laststart, colstop) 
            if (i < k) {
              conovertestptable(i,P.adjust,laststart, colstop,Reject,0)
              }
             else {
              conovertestptable(i,P.adjust,laststart, colstop,Reject,1)
              }
            }
          }
        }
  
      # Replication loop for <=7 groups
      if (k <= 7) {
        conovertestheader(g,1,kminusone,rmc)
        # Table body
        for (i in 2:k) {
          colstop <- i-1
          conovertestttable(g,i,Tvalues,1,colstop) 
          if (i < k) {
            conovertestptable(i,P.adjust,1,colstop,Reject,0)
            }
           else {
            conovertestptable(i,P.adjust,1,colstop,Reject,1)
            }
          }
        }
      }
  
    # Replication loop for >7 groups, with wrap
    if (wrap==TRUE) {
      conovertestheader(g,1,kminusone,rmc)
      # Table body
      for (i in 2:k) {
        colstop <- i-1
        conovertestttable(g,i,Tvalues,1,colstop) 
        if (i < k) {
          conovertestptable(i,P.adjust,1,colstop,Reject,0)
          }
         else {
          conovertestptable(i,P.adjust,1,colstop,Reject,1)
          }
        }
      }
      
    cat("\n")
    }

  # Output pairwise comparisons as a list if requested.
  if (list==TRUE) {
    groupvalues  <- levels(factor(g))
    # get the lengths of each group name (whether explicitly labeled or not)
    lengths <- sort(unlist(lapply(groupvalues,nchar)))
    # stringlength will be the sum of the two largest values in lengths plus 6
    stringlength <- lengths[length(lengths)] + lengths[length(lengths)-1] + 6

    # Output list header
    if (tolower(method)=="none") {
      cat("\nList of pairwise comparisons: t statistic (p-value)\n")
      }
     else {
      cat("\nList of pairwise comparisons: t statistic (adjusted p-value)\n")
      }
    cat(paste0(rep("-",stringlength+18+max(Reject)),collapse=""))
    cat("\n")
    index <- 0
    for (i in 2:k) {
      for (j in 1:(i-1)) {
        index <- index + 1
          buffer <- max(stringlength - (nchar(groupvalues[i]) + nchar(groupvalues[j]) + 4) - 2,0)
          if ( Reject[index] == 0) {
            pformatted <- paste0("(",pformat(P.adjust[index]),")",sep="")
            }
           else {
           	pformatted <- paste0("(",pformat(P.adjust[index]),")","*",sep="")
           	}
        if (rmc==FALSE) {
          cat(groupvalues[j]," - ",groupvalues[i],paste(rep(" ",buffer))," : ",tformat(Tvalues[index]), " ",pformatted,"\n", sep="")
          }
        if (rmc==TRUE) {
          cat(groupvalues[i]," - ",groupvalues[j],paste(rep(" ",buffer))," : ",tformat(Tvalues[index]), " ",pformatted,"\n", sep="")
          }

        }
      }
    cat("\n")
    }

  cat("alpha = ",alpha,"\n",sep="")
  # If p = P(T <= |t|)
  if (altp==FALSE) {
    cat("Reject Ho if p <= alpha/2\n")
    }
   # Otherwise, if p = P(|T| <= |t|)
   else {
    cat("Reject Ho if p <= alpha\n")
    }

  # Create comparisons variable for returned values (whether the list option
  # is TRUE or FALSE
  comparisons <- rep(NA,(k*(k-1)/2))
  groupvalues  <- levels(factor(g))
  index <- 0
  for (i in 2:k) {
    for (j in 1:(i-1)) {
      index <- index + 1
      if (rmc==FALSE) {
        comparisons[index] <- paste0(groupvalues[j]," - ",groupvalues[i])
        }
      if (rmc==TRUE) {
        comparisons[index] <- paste0(groupvalues[i]," - ",groupvalues[j])
        }
      }
    }
   
  # If p = P(T <= |t|)
  if (altp==FALSE) {
   invisible(list(chi2=chi2, T=Tvalues, P=P, P.adjusted=P.adjust, comparisons=comparisons))
   }
   # Otherwise, if p = P(|T| <= |t|)
   else {
   invisible(list(chi2=chi2, T=Tvalues, altP=P, altP.adjusted=P.adjust, comparisons=comparisons))
   }
  
  }
```

Відповідно до вищезазначеного, було проведено тест Коновера-Імана таким чином:

```{r}
conover.test(L4$weight, L4$group)
```

#### Old-Middle

Різниця між даними групами є статистично значимою на рівні 0,0000. Враховуючи, що p\<0,05, то різниця між даними групами є статистично значущою.

#### Young-Middle

Різниця між даними групами є статистично значимою на рівні 0,0000. Враховуючи, що p\<0,05, то різниця між даними групами є статистично значущою.

#### Young-Old

Різниця між даними групами є статистично значимою на рівні 0,0000. Враховуючи, що p\<0,05, то різниця між даними групами є статистично значущою.

### Leg Length

Спочатку було проаналізовано дані для показнику в різних групах наступним чином:

```{r}
print(summary_by_leglength <- L4 %>%
        group_by(group) %>%
        summarise(across(starts_with("leglength"), list(
          Mean = ~ mean (., na.rn = TRUE),
          Median = ~ median (., na.rn = TRUE),
          SD = ~ sd(., na.rm = TRUE),
          SEM = ~ sd(., na.rm = TRUE) / sqrt(sum(!is.na(.))),
          Q1 = ~ quantile(., 0.25, na.rm = TRUE),
          Q2 = ~ quantile(., 0.75, na.rm = TRUE),
          Total_count = ~sum(!is.na(.)),
          Min = ~ min(., na.rm = TRUE),
          Max = ~ max(., na.rm = TRUE)
        ))))
```

```{r}
ggplot(L3, aes(x = factor(group, levelc=c('Young', 'Middle', 'Old')), y = leglength)) +
+    geom_boxplot() +
+    labs(title = "Distribution of Leg Length in Young, Middle, Old",
+         x = "Group",
+         y = "Height, m")
```

Далі було визначено чи нормально розподілені дані для цього показника в групах.

### Тест Шапіро-Вілка

Надалі було проведено тест Шапіро-Вілка для визначення нормальності:

```{r}
tapply(L4$leglength, L4$group, shapiro_test_by_group)
```

#### Young

В результаті теста Шапіро-Вілка було визначено, що критерій W становить 0,85, р = 0,048. Оскільки p \< 0,05, то дані в даній групі для даного показника є ненормально розподіленими.

Для даної групи показник довжини ноги варіює в проміжку 0,51 м. Медіанне значення становить 0,53[0,51; 0,56] м.

#### Middle

В результаті теста Шапіро-Вілка було визначено, що критерій W становить 0,95, р = 0,32. Оскільки p \> 0,05, то дані в даній групі для даного показника є нормально розподіленими.

Для даної групи показник довжини ноги варіює в проміжку 0,53-0,76 м, середнє значення становить 0,64±0,05 м, стандартна похибка - 0,01, медіанне значення становить 0,64[0,62; 0,66].

#### Old

В результаті теста Шапіро-Вілка було визначено, що критерій W становить 0,91, р = 0,21. Оскільки p \> 0,05, то дані в даній групі для даного показника є нормально розподіленими.

Для даної групи показник довжини ноги варіює в проміжку 0,71-0,94 м, середнє значення становить 0,79±0,07 м, стандартна похибка - 0,02. Медіанне значення становить 0,79[0,74; 0,84] м.

### Тест Левене

Далі було проведено тест Левене для дослідження гомогенності варіанс в різних групах наступним чином:

```{r}
leveneTest(leglength ~ group, data = L4)
```

Оскільки p\>0,05, то статистично значимої різниці між варіансами в групах немає.

### Вибір однофакторного багатовибіркового тесту

Тест Шапіро-Вілка, нормальність: - + +

Тест Левене, гомогенність вибірок: +

Виявлено ненормальний розподіл - примінюємо непараметричний метод.

Виявлено гомогенність вибірок - для порівняння трьох незалежних груп застосовуємо критерій Краскела-Воліса. Він ґрунтується на рангах, а тому нечутливий до порушення нормальності розподілу.

### Критерій Краскера-Воліса

Враховуючи все вищезазначене проводимо тест Краскера-Воліса наступним чином:

```{r}
kruskal.test(leglength ~ group, data = (L4))
```

Оскільки p\<0,05, то щонайменше одна група значно відрізняється від інших. Враховуючи це, проводимо post hoc порівняння:

```{r}
pairwise.wilcox.test(L4$leglength, L4$group, p.adjust.method = 'holm')
```

#### Old - Middle

Різниця між даними групами є статистично значимою на рівні 3,2\*10\^(-05). Враховуючи, що p \< 0,05, то різниця між даними групами є статистично значущою.

#### Young - Middle

Різниця між даними групами є статистично значимою на рівні 3,7\*10\^(-05). Враховуючи, що p \< 0,05, то різниця між даними групами є статистично значущою.

#### Young - Old

Різниця між даними групами є статистично значимою на рівні 5,0\*10\^(-05). Враховуючи, що p \< 0,05, то різниця між даними групами є статистично значущою.

## Speed

Спочатку було проаналізовано дані для показнику в різних групах наступним чином:

```{r}
print(summary_by_speed <- L4 %>%
        group_by(group) %>%
        summarise(across(starts_with("speed"), list(
          Mean = ~ mean (., na.rn = TRUE),
          Median = ~ median (., na.rn = TRUE),
          SD = ~ sd(., na.rm = TRUE),
          SEM = ~ sd(., na.rm = TRUE) / sqrt(sum(!is.na(.))),
          Q1 = ~ quantile(., 0.25, na.rm = TRUE),
          Q2 = ~ quantile(., 0.75, na.rm = TRUE),
          Total_count = ~sum(!is.na(.)),
          Min = ~ min(., na.rm = TRUE),
          Max = ~ max(., na.rm = TRUE)
        ))))
```

```{r}
ggplot(L4, aes(x = factor(group, levelc=c('Young', 'Middle', 'Old')), y = speed)) +
+    geom_boxplot() +
+    labs(title = "Distribution of Speed in Young, Middle, Old",
+         x = "Group",
+         y = "Speed, m/s")
```

Далі було визначено чи нормально розподілені дані для цього показника в групах.

### Тест Шапіро-Вілка

Надалі було проведено тест Шапіро-Вілка для визначення нормальності:

```{r}
tapply(L4$speed, L4$group, shapiro_test_by_group)
```

#### Young

В результаті теста Шапіро-Вілка було визначено, що критерій W становить 0,94, р = 0,56. Оскільки p \> 0,05, то дані в даній групі для даного показника є нормально розподіленими.

Для даної групи показник швидкості ходи варіює в проміжку 0,83-1,14 м/сек, середнє значення становить 1,00±0,09 м/сек, стандартне відхилення - 0,03. Медіанне значення становить 1,02[0,95; 1,05] м/сек.

#### Middle

В результаті теста Шапіро-Вілка було визначено, що критерій W становить 0,96, р = 0,57. Оскільки p \> 0,05, то дані в даній групі для даного показника є нормально розподіленими.

Для даної групи показник швидкості ходи варіює в проміжку 1,01-1,49 м/сек, середнє значення становить 1,20±0,09 м/сек, стандартне відхилення - 0,27. Медіанне значення становить 1,20[1,11; 1,27] м/сек.

#### Old

В результаті теста Шапіро-Вілка було визначено, що критерій W становить 0,98, р = 0,98. Оскільки p \> 0,05, то дані в даній групі для даного показника є нормально розподіленими.

Для даної групи показник швидкості ходи варіює в проміжку 1,11-1,48 м/сек, середнє значення становить 1,28±0,09 м/сек, стандартне відхилення - 0,03. Медіанне значення становить 1,28[1,23; 1,33] м/сек.

### Тест Левене

Далі було проведено тест Левене для дослідження гомогенності варіанс в різних групах наступним чином:

```{r}
leveneTest (speed ~ group, data=L4)
```

Оскільки p\>0,05, то варіанси в групах рівнозначні.

### Вибір однофакторного багатовибіркового тесту

Тест Шапіро-Вілка, нормальність: + + +

Тест Левене, гомогенність вибірок: +

Виявлено нормальний розподіл - примінюємо параметричний метод.

Виявлено гомогенність вибірок - однофакторний дисперсійний аналіз.

### ANOVA

Враховуючи вищезазначене, було проведено однофакторний дисперсійний аналіз таким чином:

```{r}
res.aov <- aov(weight ~ group, data = L4)
summary.aov (res.aov)
```

Однофакторний дисперсійний аналіз виявив значущий ефект віку на швидкість [F(2, 40) = 68, p = 1,53\*10\^(-13))]. Враховуючи це, проводимо параметричне post hoc порівняння:

```{r}
TukeyHSD(res.aov)
```

Застосування post hoc тесту Тьюкі показало:

#### Old - Middle

Різниця між даними групами є статистично значимою на рівні 0,000000. Враховуючи, що p\<0,05, то різниця між даними групами є статистично значущою.

#### Young - Middle

Різниця між даними групами є статистично значимою на рівні 0,0020979. Враховуючи, що p\<0,05, то різниця між даними групами є статистично значущою.

#### Young - Old

Різниця між даними групами є статистично значимою на рівні 0,000000 Враховуючи, що p\<0,05, то різниця між даними групами є статистично значущою.

## Висновки

-   Було представлено дані 50 осіб, що поділено на 3 групи: Young (11 осіб віком від 40 до 58 місяців), Middle (20 осіб віком від 79 до 94 місяців), Old (12 осіб від 133 до 163 місяців). Для 7 осіб група не була визначена. Особи з невизначеною групою мали вік в діапазонах 61-68 місяців та 101-130 місяців. Для даних осіб аналіз не було проведено.

-   Порівняння показників зросту в групах Young, Middle, Old за допомогою тесту Краскера-Воліса виявило значущу різницю між аналізованими групами: 1,03[1,02; 1,07] м у групі Young, 1,27[1,22; 1,30] м у групі Middle та 1,03[1,49; 1,63] м у групі Old (p ≤ 0.05).

-   Порівняння показників ваги в групах Young, Middle, Old за допомогою критерію Коновера-Імена виявило значущу різницю між аналізованими групами: 16,80[15,90; 18,40] кг у групі Young, 24,90[22,50; 27,40] кг у групі Middle та 40,60[37,80; 48,20] кг у групі Old (p ≤ 0.05).

-   Порівняння показників довжини ноги в групах Young, Middle, Old за допомогою тесту Краскера-Воліса виявило значущу різницю між аналізованими групами: 0,53[0,51;0,56] м у групі Young, 0,66[0,62;0,66] м у групі Middle та 0,79[0,74;0,84] м у групі Old (p ≤ 0.05).

-   Порівняння показників швидкості ходи в групах Young, Middle, Old за допомогою тесту однофакторного дисперсійного аналізу виявило значущу різницю [F(2, 40) = 68, p = 1,53\*10\^(-13))] між групами Young-Middle (p = 0,000000), Young-Old (0,0020979) та Old-Middle (p = 0,000000): 1,00±0,09 м/сек у групі Young, 1,20±0,09 м/сек у групі Middle та 1,28±0,09 м/сек у групі Old.

# Завдання 5

Для початку було переведено таблицю в довгий формат з використанням Excel. Після цього імпортували таблицю.

```{r}
library(readxl)
L5 <- read_excel("D:/work_biph/phd/study/stat/L5.xlsx", 
    col_types = c("numeric", "numeric", "text"))
View(L5)
```

В таблиці представлені дані щодо рівня холестеролу (ммоль/л) в крові 8 щурів, яких утримували на 3 типах дієт: звичайна (Regular), дієта з зменшеним вмістом жирів (LowFat), дієта з повищеним вмістом жирів (HighFat). Для кожного щура по три виміри, тому вибірка є збалансованою.

Далі дані було описано та створено графіки, що їх візуалізують:

```{r}
summary(L5$Chol[L5$Diet == 'Regular'])
```

```{r}
summary(L5$Chol[L5$Diet == 'LowFat'])
```

```{r}
summary(L5$Chol[L5$Diet == 'HighFat'])
```

```{r}
sd(L5$Chol[L5$Diet == 'Regular'])
```

```{r}
sd(L5$Chol[L5$Diet == 'LowFat'])
```

```{r}
sd(L5$Chol[L5$Diet == 'HighFat'])
```

```{r}
ggplot(L5, aes(x = factor(Diet, levelc=c('LowFat', 'Regular', 'HighFat')), y = Chol)) +
+    geom_boxplot() +
+    labs(title = "Repeated Measures of Levels of Cholosterol in Blood of Rats",
+         x = "Diet",
+         y = "Cholesterol, mmol/l")
```

```{r}
interaction.plot(L5$Diet, L5$Rat, L5$Chol,
                 main = "Interaction Plot of Diet and Cholesterol Levels by Rat",
                 xlab = "Diet",
                 ylab = "Cholesterol, mmol/l")
```

## Перевірка на нормальність з використанням тесту Шапіро-Вілка

Перевіряли розподіл даних в групах на нормальність наступним чином:

```{r}
tapply(L5$Chol, L5$Diet, shapiro_test_by_group)
```

### LowFat

В результаті теста Шапіро-Вілка було визначено, що критерій W становить 0,98, р = 0,96. Оскільки p \> 0,05, то дані в даній групі для даного показника є нормально розподіленими.

### Regular

В результаті теста Шапіро-Вілка було визначено, що критерій W становить 0,97, р = 0,93. Оскільки p \> 0,05, то дані в даній групі для даного показника є нормально розподіленими.

### HighFat

В результаті теста Шапіро-Вілка було визначено, що критерій W становить 0,92, р = 0,43. Оскільки p \> 0,05, то дані в даній групі для даного показника є нормально розподіленими.

## Аналіз сферичності

Далі була проведено аналіз сферичності даних наступним чином:

```{r}
library(ez)
```

```{r}
ezANOVA (data=L5, dv=.(Chol), wid = .(Rat), within = .(Diet), type = 3)
```

Оскільки р \< 0.05, то сферичність даних відсутня. Надалі використовуємо корекції сферичності. Оскільки Greenhouse-Geisser менший за 0,75 - використовуємо цю поправку.

## Дисперсійний аналіз з повторюваними вимірами

ANOVA з повторюваними вимірами проводили наступним способом:

```{r}
anova_results <- ezANOVA(data = L5,
                         dv = Chol,
                         wid = Rat,
                         within = Diet,
                         return_aov = TRUE,
                         type = 'III')
print(anova_results)
```

Однофакторний дисперсійний аналіз виявив значущий ефект типу дієти щурів на рівень холестеролу в крові щурів [F(2, 14) = 15,31, p = 0,0003].

Враховуючи це, проводимо параметричне post hoc порівняння:

```{r}
stat.test <- L5 %>%
  pairwise_t_test (
    Chol ~ Diet, paired = TRUE,
    p.adjust.method = 'bonferroni'
  )
print(stat.test)
```

Post-hoc аналіз показав, що рівень холестеролу у щурів за умови перебування на різних дієтах значно відрізняється в групах LowFat-HighFat (p \< 0,05) та в групах Regular-HighFat (p \< 0,0001), проте не відрізняється в групах LowFat-Regular (p \> 0,05).

## Висновки

-   Рівень холестеролу щурів з нормальною дієтою варіював в проміжку від 1,500 ммоль/л та 3,500 ммоль/л, середнє значення становило 2,487+-0,649 ммоль/л. Після зміни дієти зі звичайної на дієту шляхом зменшення вмісту жиру на 20% показник холестеролу варіював в проміжку між 1,700 ммоль/л та 3,100 ммоль/л, середнє значення становило 2,312+-0,458 ммоль/л. Після зміни дієти на дієту зі збільшеним вмістом жирів, тобто дієта, що містила на 20% більше жирів в порівнянні зі звичайною, рівень холестеролу знаходився в проміжку між 2,000 ммоль/л та 3,900 ммоль/л, середнє значення становило 2,913+-0,689 ммоль/л.

-   Рівень холестеролу в крові щурів статистично значуще відрізняється в залежності від типу дієти щура: [F(2, 14) = 15,31, p = 0,0003], узагальнений показник ges = 0,16.

-   Post hoc pairwise t-тест з поправкою Бонфероні показав, що статистично значима різниця (р \<= 0,05) спостерігається між рівнями холестеролу за дієт зі зниженим вмістом жирів (LowFat) та за дієти з підвищеним вмістом жирів (HighFat). Також статистично значима різниця (р \<= 0,05) присутня між рівнями холестеролу за звичайної дієти (Regular) та дієти з підвищеним вмістом жирів (HighFat). При цьому між показниками холестеролу за дієти зі зниженим вмістом жирів (LowFat) та звичайної (Regular) статистично значимої різниці немає (p \> 0,05).

# Завдання 7.1

Для початку було імпортовано таблицю, що містить спрощені назви в першому рядку та змінений тип даних на "numeric" в стовпчиках, які цього потребують.\

```{r}
library(readxl)
L7 <- read_excel("D:/work_biph/phd/study/stat/L7.xlsx", 
    col_types = c("text", "text", "numeric", 
        "text", "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric"))
View(L7)
```

Загалом представлено дані 166 осіб, що поділено на 2 групи: контрольна (СО, 93 особи) та хворі на хворобу Паркінсона (PD, 73 особи).\

Далі було додано необхідні для подальшої роботи пакети:\

```{r}
library(corrplot)
library(psych)
```

Надалі проводили кореляційний аналіз між параметрами: вік ("age"); зріст ("height"); вага ("weight"); шкали хвороби Хен-Яра ("hy"), уніфікована шкала вираженості симптомів хвороби Паркінсона ("uprds), уніфікована шкала вираженості симптомів хвороби Паркінсона з моторними симптомами ("updrsm"); результати локомоторних тестів швидкості ходи ("s01") та "встати та піти" ("tuag"). Аналіз проводили серед пацієнтів із хворобою Паркінсона.\

Для початку було змінено дані в колонці "height" через те, що частина даних представлені не в метрах, як зазначено в назві колонки, а в сантиметрах. Оскільки нам всюди потрібно щоб дані були в одному форматі та одній розмірності, то дані було безпосередньо в початковому датасеті. Для цього всі значення, більші за 3 (на випадок, якщо є хтось вище за 2 м) були поділені на 100 наступним чином:

```{r}
L7$height <- ifelse (L7$height > 3 & !is.na(L7$height), L7$height / 100, L7$height)
```

Далі виділили окремо дані для хворих на хворобу Паркінсона:

```{r}
pd <- L7[which(L7$group=='PD'),]
```

Провели тест Шапіро на нормальність

```{r}
data_col <- c("age", "height", "weight", "hy", "updrs", "updrsm", "s01", "tuag")
pd_data_col <- L7[, data_col]
shapiro_result <- L7[, data_col]
shapiro_pd <- function(column_name, pd_data_col) {
+    shapiro_result <- shapiro.test(pd_data_col)
+    cat("Variable:", column_name, "\n")
+    cat("W statistic:", shapiro_result$statistic, "\n")
+    cat("P-value:", shapiro_result$p.value, "\n\n")}
```

```{r}
Map(shapiro_pd, data_col, pd_data_col)
```

Згідно з отриманими результатами, дані розподілені нормально для показників вік ("age"), зріст ("height") та вага ("weight"), адже для цих даних p \> 0,05 (0,11; 0,52; 0,09 відповідно). Для всіх інших показників дані не розподілені нормально, на що вказує те, що p \< 0,05 ("hy" - 3,51*10\^(-13); "updrsm" - 5,19*10\^(-07); "s01" - 0,00; "tuag" - 1,25\*10\^(-15)).\

Оскільки частина даних не розподілена нормально, то надалі використовуємо непараметричні методи, зокрема коєфіцієнт рангової кореляції Спірмана\

Потім були обраховані коєфіцієнти кореляції та візуалізовано отримані результати з використанням корелограми:

```{r}
cor_test_result <- corr.test(pd[, c("age", "height", "weight", "hy", "updrs", "updrsm", "s01", "tuag")], use = "pairwise.complete.obs", method = "spearman")
print (cor_test_result)
```

```{r}
cor_matrix <- cor(pd[, c("age", "height", "weight", "hy", "updrs", "updrsm", "s01", "tuag")], use = "complete.obs", method = "spearman")
corrplot(cor_matrix, method = "color", type = "upper", tl.cex = 0.7, tl.col = "black", tl.srt = 45)
```

Силу кореляції визначали наступним чином:

-   0.00 - 0.19: Дуже слабка кореляція

-   0.20 - 0.39: Слабка кореляція

-   0.40 - 0.59: Помірна кореляція

-   0.60 - 0.79: Сильна кореляція

-   0.80 - 1.00: Дуже сильна кореляція

    ## Висновки:

    В проведеному кореляційному аналізі виявлено:

-   дуже слабку негативну кореляцію між віком та зростом (r = -0,03, p \> 0,05) у пацієнтів з хворобою Паркінсона

-   дуже слабку негативну кореляцію між віком та вагою (r = -0,09, p \> 0,05) у пацієнтів з хворобою Паркінсона

-   слабку позитивну кореляцію між віком та показником шкали хвороби Хен-Яра (r = 0,27, p \> 0,05) у пацієнтів з хворобою Паркінсона

-   дуже слабку негативну кореляцію між віком та показником уніфікованої шкали вираженості симптомів хвороби Паркінсона (r = -0,12, p \> 0,05) у пацієнтів з хворобою Паркінсона

-   дуже слабку негативну кореляцію між віком та показником уніфікованої шкали вираженості симптомів хвороби Паркінсона з моторними симптомами (r = -0,19, p \> 0,05) у пацієнтів з хворобою Паркінсона

-   помірну негативну кореляцію між віком та результатами тесту на швидкість ходи (r = -0,41, p \> 0,05) у пацієнтів з хворобою Паркінсона

-   слабку позитивну кореляцію між віком та результатами тесту "встати та піти" (r = 0,39, p \< 0,05) у пацієнтів з хворобою Паркінсона помірну позитивну кореляцію між зростом та вагою (r = 0,53, p \> 0,05) у пацієнтів з хворобою Паркінсона

-   дуже слабку негативну кореляцію між зростом та показником шкали хвороби Хен-Яра (r = -0,27, p \> 0,05) у пацієнтів з хворобою Паркінсона

-   дуже слабку позитивну кореляцію між зростом та показником уніфікованої шкали вираженості симптомів хвороби Паркінсона (r = 0,16, p \> 0,05) у пацієнтів з хворобою Паркінсона

-   дуже слабку позитивну кореляцію між зростом та показником уніфікованої шкали вираженості симптомів хвороби Паркінсона з моторними симптомами (r = 0,17, p \> 0,05) у пацієнтів з хворобою Паркінсона

-   дуже слабку позитивну кореляцію між зростом та результатами тесту на швидкість ходи (r = 0,13, p \> 0,05) у пацієнтів з хворобою Паркінсона

-   дуже слабку позитивну кореляцію між зростом та результатами тесту "встати та піти" (r = 0,11, p \> 0,05) у пацієнтів з хворобою Паркінсона

-   дуже слабку негативну кореляцію між вагою та показником шкали хвороби Хен-Яра (r = -0,11, p \> 0,05) у пацієнтів з хворобою Паркінсона

-   дуже слабку позитивну кореляцію між вагою та показником уніфікованої шкали вираженості симптомів хвороби Паркінсона (r = 0,12, p \> 0,05) у пацієнтів з хворобою Паркінсона

-   дуже слабку позитивну кореляцію між вагою та показником уніфікованої шкали вираженості симптомів хвороби Паркінсона з моторними симптомами (r = 0,14, p \> 0,05) у пацієнтів з хворобою Паркінсона

-   дуже слабку позитивну кореляцію між вагою та результатами тесту на швидкість ходи (r = 0,14, p \> 0,05) у пацієнтів з хворобою Паркінсона

-   дуже слабку позитивну кореляцію між вагою та результатами тесту "встати та піти" (r = 0,04, p \> 0,05) у пацієнтів з хворобою Паркінсона

-   дуже слабку позитивну кореляцію між показником шкали хвороби Хен-Яра та показником уніфікованої шкали вираженості симптомів хвороби Паркінсона (r = 0,19, p \> 0,05) у пацієнтів з хворобою Паркінсона

-   дуже слабку негативну кореляцію між показником шкали хвороби Хен-Яра та показником уніфікованої шкали вираженості симптомів хвороби Паркінсона з моторними симптомами (r = -0,01, p \> 0,05) у пацієнтів з хворобою Паркінсона

-   слабку негативну кореляцію між показником шкали хвороби Хен-Яра та результатами тесту на швидкість ходи (r = -0,28, p \> 0,05) у пацієнтів з хворобою Паркінсона

-   слабку позитивну кореляцію між показником шкали хвороби Хен-Яра та результатами тесту "встати та піти" (r = 0,23, p \< 0,05) у пацієнтів з хворобою Паркінсона

-   дуже сильну позитивну кореляцію між показником уніфікованої шкали вираженості симптомів хвороби Паркінсона та показником уніфікованої шкали вираженості симптомів хвороби Паркінсона з моторними симптомами (r = 0,89, p \< 0,05) у пацієнтів з хворобою Паркінсона

-   дуже слабку негативну кореляцію між показником уніфікованої шкали вираженості симптомів хвороби Паркінсона та результатами тесту на швидкість ходи (r = -0,07, p > 0,05) у пацієнтів з хворобою Паркінсона слабку позитивну кореляцію між показником уніфікованої шкали вираженості симптомів хвороби Паркінсона та результатами тесту "встати та піти" (r = 0,27, p \> 0,05) у пацієнтів з хворобою Паркінсона

-   дуже слабку негативну кореляцію між показником уніфікованої шкали вираженості симптомів хвороби Паркінсона з моторними симптомами та результатами тесту на швидкість ходи (r = -0,04, p \7> 0,05) у пацієнтів з хворобою Паркінсона

-   слабку позитивну кореляцію між показником уніфікованої шкали вираженості симптомів хвороби Паркінсона з моторними симптомами та результатами тесту "встати та піти" (r = 0,23, p \> 0,05) у пацієнтів з хворобою Паркінсона

-   помірну позитивну кореляцію між результатами тесту на швидкість ходи та результатами тесту "встати та піти" (r = -0,53, p \< 0,05) у пацієнтів з хворобою Паркінсон

## Завдання 7.2

```{r}
library(readxl)
L7 <- read_excel("D:/work_biph/phd/study/stat/L7.xlsx", 
    sheet = "smoking")
View(L7)
```

Для початку було імпортовано таблицю. В таблиці представлено дані щодо 356 осіб. Дані стосовно статусу тютюнопаління, які включають категорії "ніколи не курили", "курять в даний момент" та "покинули куріння", порівнюються із соціоекономічним статусом.\

Далі було додано необхідні для подальшої роботи пакети:\

```{r}
install.packages("vcd")
library(vcd)
```

Візуалізували наявні дані:

```{r}
smtable <- table(L7$Smoke, L7$SES)
mosaicplot(smtable, main = "Association between Smoking Status and Socioeconomic Status")
```

Оскільки всі дані є категоріальними, то надалі використовували хі-квадрат:

```{r}
result <- chisq.test(L7$Smoke, L7$SES)
print(result)
```

Оскільки р < 0,05, то нульова гіпотеза про відсутність залежності між статусом тютюнопаління та соціоекономічним статусом відхиляється, а отже у нас присутній значущий зв´язок між зазначеними вище категоріальними змінами\

## Висновки

Тест на незалежність з використанням критерію хі-квадрат виявив статистично значущий звʼязок між статусами тютюнопаління та соціоекономічним (хі-квадрат = 18,51, df = 4, p < 0,05
